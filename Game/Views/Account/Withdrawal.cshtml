@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Withdrawal</title>
    <link href="~/css/bootstrap.css" rel="stylesheet" />
    <link href="~/css/jquery.autocomplete.css" rel="stylesheet" />
    <link href="~/css/css.css" rel="stylesheet" />
    <script src="~/js/jquery1.9.0.min.js"></script>
    <script src="~/js/bootstrap.min.js"></script>
    <script src="~/js/sdmenu.js"></script>
    <script src="~/js/laydate/laydate.js"></script>
    <script src="~/js/autocomplete/jquery.autocomplete.min.js"></script>
</head>
<body>
    <div class="header">
        <div class="logo"><img src="img/logo.png" /></div>

        <div class="header-right">
            @*<i class="icon-question-sign icon-white"></i> <a href="#"></a>*@
            <i class="icon-off icon-white"></i> <a id="modal-973558" href="#modal-container-973558" role="button" data-toggle="modal">退出系统</a>
            <i class="icon-user icon-white"></i> <a>当前用户：超级管理员</a> @*<i class="icon-envelope icon-white"></i>*@ <a href="#"></a>
            <div id="modal-container-973558" class="modal hide fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="width:300px; margin-left:-150px; top:30%">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h3 id="myModalLabel">
                        注销系统
                    </h3>
                </div>
                <div class="modal-body">
                    <p>
                        您确定要注销退出系统吗？
                    </p>
                </div>
                <div class="modal-footer">
                    <button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button> <a class="btn btn-primary" style="line-height:20px;" href="/home/index/">确定退出</a>
                </div>
            </div>
        </div>
    </div>
    <!-- 顶部 -->

    <div id="middle">
        <div class="left">

            <script type="text/javascript">
                var myMenu;
                window.onload = function () {
                    myMenu = new SDMenu("my_menu");
                    myMenu.init();
                };
            </script>

            <div id="my_menu" class="sdmenu">
                <div>
                    <span>业务处理</span>
                    <a href="/Account/Recharge">账户充值</a>
                    <a href="/Account/Withdrawal">账户提现</a>
                    <a href="/Account/AccountDetail"> 账户查询 </a>
                    <a href="/game/index">开始游戏</a>
                </div>
            </div>

        </div>
        <div class="Switch"></div>
        <script type="text/javascript">
            $(document).ready(function (e) {
                $(".Switch").click(function () {
                    $(".left").toggle();

                });
            });
        </script>

        <div class="right" id="mainFrame">

            <div class="right_cont">
                <ul class="breadcrumb">
                    当前位置：
                    <a href="#">首页</a>
                    <span class="divider">/</span>
                    <a href="#">账户体现</a>
                </ul>
                <div class="title_right"><strong>账户体现</strong></div>
                <div style="width:900px; margin:auto">
                    <table class="table table-bordered">
                        <tr>
                            <td width="10%" align="right" nowrap="nowrap" bgcolor="#f1f1f1">账户名：</td>
                            <td width="50%"><input type="text" class="span1-1" id="UserName" /> </td>
                        </tr>
                    </table>

                    @*<table class="margin-bottom-20 table  no-border">
                        <tr>
                            <td class="text-center"><input type="button" value="查询" class="btn btn-info " style="width:80px;" /></td>
                        </tr>
                    </table>*@
                    <table id="tbAccount" class="table table-bordered table-hover table-striped">
                        <thead>
                            <tr align="center">
                                <td><strong>No</strong></td>
                                <td><strong>账户名</strong></td>
                                <td><strong>充值金额</strong></td>
                                <td><strong>可提现金额</strong></td>
                                <td><strong>操作</strong></td>
                            </tr>
                        </thead>
                        <tbody>
               
                        @*<tr align="center">
                                <td>1</td>
                                <td>华商汇二部分理处</td>
                                <td>18701</td>
                                <td>110517</td>
                                <td><a id="DataGrid1_ctl03_LinkButton1" href="javascript:__doPostBack('DataGrid1$ctl03$LinkButton1','')">详细</a></td>
                            </tr>*@

                        </tbody>
                    </table>

                    @*<table class="margin-bottom-20 table  no-border">
                        <tr>
                            <td class="text-center"><input type="button" value="打印" class="btn btn-info    margin-right-20" style="width:80px;" /><input type="button" value="数据导出" class="btn btn-info  " style="width:80px;" /></td>
                        </tr>
                    </table>*@
                </div>
            </div>
        </div>
    </div>

    <!-- 底部 -->
    <div id="footer"></div>



<script>
    !function() {
        laydate.skin('molv');
        laydate({ elem: '#Calendar' });
    }();
</script>
<script type="text/javascript">
    $(function() {
        $("#UserName").keyup(function() {
            
                GetUserAccount();
        });
    });


    function GetMoney(that,amountMoney, id) {
        var inputMoney = $(that).parent().find("input[name=inputAmount]").val();
        if (inputMoney == "") {
            alert("请输入提现金额");
            return;
        }

        if (parseFloat(inputMoney) <= 0) {
            alert("提现不能为零元，请输入大于零的金额!");
            return;
        }

        if (parseFloat(inputMoney) > parseFloat(amountMoney)) {
            alert("提现不能超过账户的最大金额");
            return;
        }

        if (confirm("确定要提现吗?")) {
            //提现
            $.ajax({
                type: 'post',
                url: '/Account/Withdrawal',
                dataType: 'json',
                data: {
                    amountMoney: inputMoney,
                    id: id
                },
                success: function(data) {
                    if (data.success == 1) {
                        $("#btnget" + id).hide();
                    }
                    GetUserAccount();
                    alert(data.msg);
                    
                },
                error: function(textThrown, errorText) {
                    alert("应用程序出错!");
                }
            });
        }
    }

    function GetUserAccount() {
        var userName = $.trim($("#UserName").val());
        if (userName == "") {
            return;
        }
        $.ajax({
            type: 'post',
            url: '/Account/UserAccountInfo',
            dataType: 'json',
            async:false,
            data: {
                userName: userName
            },
            success: function (data) {
                var result = "";
                var j = 0;
                if (data.sucess == 1) {
                    var jsonitem = eval(data.userInfoItem);
                    $(jsonitem).each(function (k, i) {
                        j++;
                        result += "<tr align=\"center\">";
                        result += "<td>" + j + "</td>";
                        result += "<td>" + i.UserName + "</td>";
                        result += "<td>" + i.TotalMoney + "</td>";
                        result += "<td>" + i.AmountMoney + "</td>";

                        var fnGetMonty = "";
                        if (i.AmountMoney > 0) {
                            fnGetMonty = "onclick='GetMoney(this," + i.AmountMoney + "," + i.Id + ");'";
                            result += "<td><input type=\"text\" name=\"inputAmount\" class=\"span1-1\" />&nbsp;<input id=btnget" + i.Id + " type=\"button\" value=\"提现\" " + fnGetMonty + " class=\"btn btn-info \" style=\"width:80px;\" /></td>";
                        } else {
                            result += "<td></td>";
                        }
                        result += "</tr>";
                    }
                    );
                    $("#tbAccount tbody").html(result);
                }
            },
            error: function (textThrown, errorText) {
                alert("ajax方法Error！" + errorText);
            }
        });
    }

</script>

</body>
</html>
